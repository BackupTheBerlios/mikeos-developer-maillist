<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mikeos-developer] Windows build script updated
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/mikeos-developer/2010-January/index.html" >
   <LINK REL="made" HREF="mailto:mikeos-developer%40lists.berlios.de?Subject=Re%3A%20%5Bmikeos-developer%5D%20Windows%20build%20script%20updated&In-Reply-To=%3C718999.75022.qm%40web113107.mail.gq1.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000986.html">
   <LINK REL="Next"  HREF="000972.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mikeos-developer] Windows build script updated</H1>
    <B>Paulo Valongo</B> 
    <A HREF="mailto:mikeos-developer%40lists.berlios.de?Subject=Re%3A%20%5Bmikeos-developer%5D%20Windows%20build%20script%20updated&In-Reply-To=%3C718999.75022.qm%40web113107.mail.gq1.yahoo.com%3E"
       TITLE="[mikeos-developer] Windows build script updated">paulovalongo at rocketmail.com
       </A><BR>
    <I>Tue Jan 26 01:20:23 CET 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000986.html">[mikeos-developer] Windows build script updated
</A></li>
        <LI>Next message: <A HREF="000972.html">[mikeos-developer] Windows build script updated
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#970">[ date ]</a>
              <a href="thread.html#970">[ thread ]</a>
              <a href="subject.html#970">[ subject ]</a>
              <a href="author.html#970">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

Mike,

If you try my previous bat script, you should get the following values for %ERRORLEVEL%

nasm not found   %ERRORLEVEL% = 9009
nasm found %ERRORLEVEL% =1 
At first this had me a bit confused as when it finds nasm, %ERRORLEVEL% should be 0 and not 1.
Then it hit me, because we are calling nasm without any extra parameters, it exits but with an error
which is passed back and hence = 1.

Am I wrong ? It is pretty late.






----- Original Message ----
From: M Saunders &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/mikeos-developer">okachi at gmail.com</A>&gt;
To: MikeOS (and similar OS) developers &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/mikeos-developer">mikeos-developer at lists.berlios.de</A>&gt;
Sent: Tue, January 26, 2010 1:45:20 AM
Subject: Re: [mikeos-developer] Windows build script updated

Lo,

Alright, I think I've found the problem. In XP, this will not set
ERRORLEVEL to 9009 if NASM can't be found (although it sets it in
Windows 7):

  nasm 2&gt; nul
  if ERRORLEVEL 9009 set MIKEOS_NONASM=1

Without any redirection, however, it does work in XP:

  nasm
  if ERRORLEVEL 9009 set MIKEOS_NONASM=1

So the script will work with all references to 2&gt;nul removed, but then
there's no redirection taking place and loads of rubbish gets spewed
onto the screen, whether you have the tools or not. It's either
Windows moaning that it can't find the executable or the default blurb
from the programs.

As Paulo says, BAT files are a royal pain to deal with (although in
fairness, Microsoft does seem to have a much better, and more
Unix-like, shell in Windows 7) so I don't know how fixable this is.
Any ideas welcome!

M

-- 
Mike Saunders
<A HREF="http://okachi.googlepages.com">http://okachi.googlepages.com</A>
_______________________________________________
mikeos-developer mailing list
<A HREF="https://lists.berlios.de/mailman/listinfo/mikeos-developer">mikeos-developer at lists.berlios.de</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/mikeos-developer">https://lists.berlios.de/mailman/listinfo/mikeos-developer</A>



      

_______________________________________________
mikeos-developer mailing list
<A HREF="https://lists.berlios.de/mailman/listinfo/mikeos-developer">mikeos-developer at lists.berlios.de</A>
<A HREF="https://lists.berlios.de/mailman/listinfo/mikeos-developer">https://lists.berlios.de/mailman/listinfo/mikeos-developer</A>



      


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000986.html">[mikeos-developer] Windows build script updated
</A></li>
	<LI>Next message: <A HREF="000972.html">[mikeos-developer] Windows build script updated
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#970">[ date ]</a>
              <a href="thread.html#970">[ thread ]</a>
              <a href="subject.html#970">[ subject ]</a>
              <a href="author.html#970">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/mikeos-developer">More information about the mikeos-developer
mailing list</a><br>
</body></html>
