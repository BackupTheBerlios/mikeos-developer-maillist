<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [mikeos-developer] To optimize or not to optimize.
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/mikeos-developer/2011-July/index.html" >
   <LINK REL="made" HREF="mailto:mikeos-developer%40lists.berlios.de?Subject=Re%3A%20%5Bmikeos-developer%5D%20To%20optimize%20or%20not%20to%20optimize.&In-Reply-To=%3C5D3FA8D3CC7C4056BC906AE03A55CCB5%40userfe6b65a555%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001960.html">
   <LINK REL="Next"  HREF="001965.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[mikeos-developer] To optimize or not to optimize.</H1>
    <B>Mike Gonta</B> 
    <A HREF="mailto:mikeos-developer%40lists.berlios.de?Subject=Re%3A%20%5Bmikeos-developer%5D%20To%20optimize%20or%20not%20to%20optimize.&In-Reply-To=%3C5D3FA8D3CC7C4056BC906AE03A55CCB5%40userfe6b65a555%3E"
       TITLE="[mikeos-developer] To optimize or not to optimize.">mikegonta at gmail.com
       </A><BR>
    <I>Sat Jul 16 01:40:59 CEST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="001960.html">[mikeos-developer] Developing an application
</A></li>
        <LI>Next message: <A HREF="001965.html">[mikeos-developer] To optimize or not to optimize.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1961">[ date ]</a>
              <a href="thread.html#1961">[ thread ]</a>
              <a href="subject.html#1961">[ subject ]</a>
              <a href="author.html#1961">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>----- Original Message ----- 
From: &quot;M Saunders&quot;
To: &quot;MikeOS (and similar OS) developers&quot;
Sent: Friday, July 15, 2011 11:49 AM
Subject: Re: [mikeos-developer] Developing an application


&gt;<i> FIXED!
</I>?

&gt;<i> NASM version 2.09 turned on optimisation by default (-Ox flag). This
</I>&gt;<i> causes problems with MikeOS. If you change the MikeOS build scripts so
</I>&gt;<i> that all instances of NASM are called with &quot;-O0&quot; (dash oh zero) then
</I>&gt;<i> it builds correctly and MEMVIEW.BAS works.
</I>
I assembled the latest MikeOS 4.1.1-rc2 KERNEL.ASM with NASM-2.09.10-win32.
Even with maximum optimization it works just fine on WINXP with qemu.

-O0  = 13,421 bytes
-O1  = 14,058 bytes
-O2  = 13,257 bytes
-O90 = 13,257 bytes

These are only simple optimizations. Immediate operands which will fit in a
signed byte are optimized and branch offsets and signed immediate bytes are
minimized. These shouldn't adversly effect the operation of the code.

Incidentally when assembled with FASM (my personal assembler of choice)
the resulting file is even smaller at 13,248 bytes (and of course works
just fine). FASM by design is a multipass optimizing assembler. The file
requires a small number of assembler directive syntax changes in order to
assemble, but the assembly language code is exactly the same.


Mike Gonta
look and see - many look but few see

<A HREF="http://aeBIOS.com">http://aeBIOS.com</A>



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001960.html">[mikeos-developer] Developing an application
</A></li>
	<LI>Next message: <A HREF="001965.html">[mikeos-developer] To optimize or not to optimize.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1961">[ date ]</a>
              <a href="thread.html#1961">[ thread ]</a>
              <a href="subject.html#1961">[ subject ]</a>
              <a href="author.html#1961">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/mikeos-developer">More information about the mikeos-developer
mailing list</a><br>
</body></html>
